<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>jira.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  <div class='section'>
    <div class='docs'><h1>jira.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>A minimal JIRA REST API client.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">import</span> <span class="nn">httplib</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">config</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">JiraAPI</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">api_path</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">host</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">api_path</span> <span class="o">=</span> <span class="n">api_path</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="s">&#39;Jira API at </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>Sends a GET request to the jira API, and returns the file handle for the response.</p>
<pre><code>response = get('issue/JRA-1/comment', 
{ 'maxResults': 20 })
print response.status, response.reason
=&gt; 200 OK
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
		<span class="n">conn</span> <span class="o">=</span> <span class="n">httplib</span><span class="o">.</span><span class="n">HTTPSConnection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span>
		<span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">({</span> <span class="s">&#39;os_username&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="s">&#39;os_password&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="p">})</span>
		<span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">/</span><span class="si">%s</span><span class="s">?</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_path</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">)))</span> 
		<span class="k">return</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Sends a request with HTTP method <code>method</code> and <code>message</code> json-encoded in the body. Returns the file handle for the response.</p>
<pre><code>response = send('POST', 'issue', { 'fields': {} })
print response.status, response.reason
=&gt; 201 Created
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
		<span class="n">conn</span> <span class="o">=</span> <span class="n">httplib</span><span class="o">.</span><span class="n">HTTPSConnection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span>
		<span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">/</span><span class="si">%s</span><span class="s">?os_username=</span><span class="si">%s</span><span class="s">&amp;os_password=</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_path</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">),</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="p">{</span> <span class="s">&#39;Content-type&#39;</span><span class="p">:</span> <span class="s">&#39;application/json&#39;</span> <span class="p">})</span> 
		<span class="n">resp</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">resp</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>Instantiates a default API class from the configuration</p>
<pre><code>JiraAPI.default_api()
=&gt; &lt;lib.jira.JiraAPI object at 0x10e7d5890&gt;
print JiraAPI.default_api()
=&gt; Jira API at jira.atlassian.com
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="nd">@classmethod</span>
	<span class="k">def</span> <span class="nf">default_api</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
		<span class="n">conf</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">default_config</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;jira_default&#39;</span><span class="p">,</span><span class="s">&#39;host&#39;</span><span class="p">),</span> <span class="n">conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;jira_default&#39;</span><span class="p">,</span><span class="s">&#39;path&#39;</span><span class="p">),</span> <span class="n">conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;jira_default&#39;</span><span class="p">,</span><span class="s">&#39;username&#39;</span><span class="p">),</span> <span class="n">conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;jira_default&#39;</span><span class="p">,</span><span class="s">&#39;password&#39;</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">APIException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">msg</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="n">response</span>

	<span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span>

<span class="k">class</span> <span class="nc">Issue</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="n">api</span> <span class="o">=</span> <span class="n">JiraAPI</span><span class="o">.</span><span class="n">default_api</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s">&#39;key&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s">&#39;fields&#39;</span><span class="p">][</span><span class="s">&#39;status&#39;</span><span class="p">][</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">summary</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s">&#39;fields&#39;</span><span class="p">][</span><span class="s">&#39;summary&#39;</span><span class="p">]</span>

	<span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>Transitions an issue to <code>state</code>.</p>
<pre><code>Issue.transition('JRA-1', 'Resolved')
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="nd">@classmethod</span>
	<span class="k">def</span> <span class="nf">transition_issue</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
		<span class="n">response</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;issue/</span><span class="si">%s</span><span class="s">/transitions&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span> <span class="p">{</span> <span class="s">&#39;fields&#39;</span><span class="p">:</span> <span class="s">&#39;name&#39;</span> <span class="p">})</span>
		<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
			<span class="k">raise</span> <span class="n">APIException</span><span class="p">(</span><span class="s">&#39;could not get transitions for issue&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
		<span class="n">available_transitions</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">response</span><span class="p">)[</span><span class="s">&#39;transitions&#39;</span><span class="p">]</span>
		<span class="n">transition</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">available_transitions</span> <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="s">&#39;to&#39;</span><span class="p">][</span><span class="s">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span>  <span class="n">state</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">transition</span><span class="p">:</span>
			<span class="n">available_states</span> <span class="o">=</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s">&#39;to&#39;</span><span class="p">][</span><span class="s">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">available_transitions</span><span class="p">)</span>
			<span class="k">raise</span> <span class="n">APIException</span><span class="p">(</span><span class="s">&quot;no transitions found to &#39;</span><span class="si">%s</span><span class="s">&#39;. Choose from: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">available_states</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
		<span class="n">response</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;POST&#39;</span><span class="p">,</span> <span class="s">&#39;issue/</span><span class="si">%s</span><span class="s">/transitions&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span> <span class="p">{</span> <span class="s">&#39;transition&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="n">transition</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;id&#39;</span><span class="p">]</span> <span class="p">}</span> <span class="p">})</span>
		<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">204</span><span class="p">:</span>
			<span class="k">raise</span> <span class="n">APIException</span><span class="p">(</span><span class="s">&#39;could not transition issue to </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">state</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>Updates an issue with <code>fields</code>.
<code>fields</code> is a <code>dict</code> and the values that you need to pass are specific to your jira instance. See the <a href="http://docs.atlassian.com/jira/REST/latest/#id161551">Atlassian docs</a></p>
<pre><code>Issue.update('JRA-1', { 'summary': 
    { 'set': 'Bug in business logic' }})
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="nd">@classmethod</span>
	<span class="k">def</span> <span class="nf">update_issue</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">fields</span><span class="p">):</span>
		<span class="n">response</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;PUT&#39;</span><span class="p">,</span> <span class="s">&#39;issue/</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span> <span class="p">{</span> <span class="s">&#39;update&#39;</span><span class="p">:</span> <span class="n">fields</span> <span class="p">})</span>
		<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">204</span><span class="p">:</span>
			<span class="k">raise</span> <span class="n">APIException</span><span class="p">(</span><span class="s">&#39;could not update issue&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>Assigns an issue to <code>assignee</code> by username.</p>
<pre><code>Issue.assign_issue('JRA-1', 'pranavraja')
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="nd">@classmethod</span>
	<span class="k">def</span> <span class="nf">assign_issue</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">assignee</span><span class="p">):</span>
		<span class="n">cls</span><span class="o">.</span><span class="n">api</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;PUT&#39;</span><span class="p">,</span> <span class="s">&#39;issue/</span><span class="si">%s</span><span class="s">/assignee&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span> <span class="p">{</span> <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">assignee</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Creates an issue with json representation in <code>fields</code>.</p>
<pre><code>Issue.create({ 'project' { 'id': 100 }, 
'summary': 'buggy', 'issuetype': { 'id': 1 }, 
'reporter': { 'name': 'pranavraja' }, ...)
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="nd">@classmethod</span>
	<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">fields</span><span class="p">):</span>
		<span class="n">response</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;POST&#39;</span><span class="p">,</span> <span class="s">&#39;issue&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="s">&#39;fields&#39;</span><span class="p">:</span> <span class="n">fields</span> <span class="p">})</span>
		<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">201</span><span class="p">:</span> 
			<span class="k">raise</span> <span class="n">APIException</span><span class="p">(</span><span class="s">&#39;could not create issue&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>Searches for issues given a JQL <code>query</code>, selecting <code>fields</code> in the response. Returns a list of <code>Issue</code> objects.</p>
<pre><code>Issue.search('assignee = pranavraja')
=&gt; [&lt;lib.Jira.Issue object at 0x107e25850&gt;,
    &lt;lib.jira.Issue object at 0x107e25851&gt;]
print Issue.search('assignee = pranavraja')[0]
=&gt; JRA-1
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="nd">@classmethod</span>
	<span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="s">&#39;summary,status&#39;</span><span class="p">):</span>
		<span class="n">response</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;search&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="s">&#39;jql&#39;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="s">&#39;fields&#39;</span><span class="p">:</span> <span class="n">fields</span> <span class="p">})</span>
		<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
			<span class="k">return</span> <span class="p">[</span><span class="n">cls</span><span class="p">(</span><span class="n">issue</span><span class="p">)</span> <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">response</span><span class="p">)[</span><span class="s">&#39;issues&#39;</span><span class="p">]]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="n">APIException</span><span class="p">(</span><span class="s">&#39;could not get issue&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>Gets a list of comments for this issue. Returns a list of <code>Comment</code> objects.</p>
<pre><code>issue.comments()
=&gt; [&lt;lib.jira.Comment object at 0x107e25910&gt;]
print issue.comments()[0]
=&gt; On hold right now.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">comments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">Comment</span><span class="o">.</span><span class="n">get_by_issue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>Adds the comment with raw text <code>body</code> to the issue. The raw text may be passed through Jira's wiki markup processor when displayed online.</p>
<pre><code>issue.add_comment('test comment')
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">add_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
		<span class="n">Comment</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>Updates this issue with <code>fields</code>.</p>
<pre><code>issue.update({ 'summary': { 'set': 'New summary' } })
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">):</span>
		<span class="n">Issue</span><span class="o">.</span><span class="n">update_issue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Assigns the issue to <code>assignee</code></p>
<pre><code>issue.assign('pranavraja')
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assignee</span><span class="p">):</span>
		<span class="n">Issue</span><span class="o">.</span><span class="n">assign_issue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">assignee</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Transitions this issue to <code>state</code>.</p>
<pre><code>issue.transition('Resolved')
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
		<span class="n">Issue</span><span class="o">.</span><span class="n">transition_issue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">Comment</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="n">api</span> <span class="o">=</span> <span class="n">JiraAPI</span><span class="o">.</span><span class="n">default_api</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">issue_key</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">issue_key</span> <span class="o">=</span> <span class="n">issue_key</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s">&#39;author&#39;</span><span class="p">][</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s">&#39;body&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Gets comments by issue with issue key <code>key</code>. Returns a list of comments.</p>
<pre><code>Comment.get_by_issue('JRA-1')
=&gt; [&lt;lib.jira.Comment object at 0x107e25910&gt;]
print Comment.get_by_issue('JRA-1')[0]
=&gt; Comment body
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="nd">@classmethod</span>
	<span class="k">def</span> <span class="nf">get_by_issue</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
		<span class="n">response</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;issue/</span><span class="si">%s</span><span class="s">/comment&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span> <span class="p">{</span> <span class="s">&#39;fields&#39;</span><span class="p">:</span> <span class="s">&#39;body&#39;</span> <span class="p">})</span>
		<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
			<span class="n">comments</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">response</span><span class="p">)[</span><span class="s">&#39;comments&#39;</span><span class="p">]</span>
			<span class="k">return</span> <span class="p">[</span><span class="n">cls</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">comments</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="n">APIException</span><span class="p">(</span><span class="s">&#39;could not get comments for </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>Gets a comment with id <code>id</code> under issue key <code>key</code>. Returns an instance of <code>Comment</code>.</p>
<pre><code>print Comment.get('JRA-1', '10191')
=&gt; Comment body
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="nd">@classmethod</span>
	<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">issue_key</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
		<span class="n">response</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;issue/</span><span class="si">%s</span><span class="s">/comment/</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">issue_key</span><span class="p">,</span><span class="nb">id</span><span class="p">),</span> <span class="p">{</span> <span class="s">&#39;fields&#39;</span><span class="p">:</span> <span class="s">&#39;body&#39;</span> <span class="p">})</span>
		<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">issue_key</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="n">APIException</span><span class="p">(</span><span class="s">&#39;could not get comment </span><span class="si">%s</span><span class="s">/</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">id</span><span class="p">),</span> <span class="n">response</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>Adds a comment <code>comment</code> for issue with key <code>issue_key</code>.</p>
<pre><code>Comment.add('JRA-1', 'Comment body')
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="nd">@classmethod</span>
	<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">issue_key</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
		<span class="n">response</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;POST&#39;</span><span class="p">,</span> <span class="s">&#39;issue/</span><span class="si">%s</span><span class="s">/comment&#39;</span> <span class="o">%</span> <span class="n">issue_key</span><span class="p">,</span> <span class="p">{</span> <span class="s">&quot;body&quot;</span><span class="p">:</span> <span class="n">comment</span> <span class="p">})</span>
		<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">201</span><span class="p">:</span> <span class="k">raise</span> <span class="n">APIException</span><span class="p">(</span><span class="s">&#39;could not add comment&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>Updates this comment with a new body <code>body</code>. Note that the entire comment is replaced in the update.</p>
<pre><code>comment.update('new comment text')
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
		<span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;PUT&#39;</span><span class="p">,</span> <span class="s">&#39;issue/</span><span class="si">%s</span><span class="s">/comment/</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">issue_key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">),</span> <span class="p">{</span> <span class="s">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span> <span class="p">})</span>
		<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span> <span class="k">raise</span> <span class="n">APIException</span><span class="p">(</span><span class="s">&#39;could not update comment </span><span class="si">%s</span><span class="s">/</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">id</span><span class="p">),</span> <span class="n">response</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>Delete this comment.</p>
<pre><code>comment.delete()
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;DELETE&#39;</span><span class="p">,</span> <span class="s">&#39;issue/</span><span class="si">%s</span><span class="s">/comment/</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">issue_key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">),</span> <span class="p">{</span> <span class="p">})</span>
		<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span> <span class="k">raise</span> <span class="n">APIException</span><span class="p">(</span><span class="s">&#39;could not delete comment </span><span class="si">%s</span><span class="s">/</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">id</span><span class="p">),</span> <span class="n">response</span><span class="p">)</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
